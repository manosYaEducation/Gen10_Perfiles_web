<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Órdenes de Servicio</title>
  <link rel="stylesheet" href="../frontend/css/ordenes-servicios.css" />
  <link rel="stylesheet" href="../frontend/css/footer.css" />
  <link rel="stylesheet" href="./css/index-admin.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <!-- Librería SheetJS para exportar a Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

  <header>
    <nav>
      <div class="nav-left">
        <a href="../index.html" class="back-to-site">
          <i class="fas fa-arrow-left"></i> Volver al sitio
        </a>
        <img src="../assets/img/kreativenofondo.png" alt="Icono" class="icon">
      </div>
      <div class="navbar" id="navbar">
        <ul class="headernav">
          <li><a class="button-53" href="../frontend/ordenes-servicios.html">Ordenes Servicios</a></li>
          <li><a class="button-53" href="../frontend/proyectos-admin.html">Proyectos</a></li>
          <li><a class="button-53" href="../frontend/index-admin.html">Panel de Administración</a></li>
        </ul>
      </div>
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </nav>
  </header>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="ordenes-container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
      <h1 class="titulo-principal" style="margin: 0;">Órdenes de servicio</h1>
      <div style="display: flex; gap: 8px; align-items: center;">
        <div class="view-toggle" style="background: rgba(0, 0, 0, 0.05); padding: 4px; border-radius: 8px; margin-right: 10px;">
          <button class="view-toggle-btn active" id="cardsViewBtn" title="Vista de tarjetas" style="background: #fff; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 600; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <i class="fas fa-th-large"></i> Tarjetas
          </button>
          <button class="view-toggle-btn" id="tableViewBtn" title="Vista de tabla" style="background: transparent; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 500;">
            <i class="fas fa-table"></i> Tabla
          </button>
          <button class="view-toggle-btn" id="adminTableViewBtn" title="Vista de Tabla Admin" style="background: transparent; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 500;">
            <i class="fas fa-user-shield"></i> Admin Tabla
          </button>
        </div>
        <button id="export-excel" class="btn-export" title="Exportar a Excel" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 6px; font-weight: 500; transition: background 0.3s;">
          <i class="fas fa-file-excel"></i> Exportar
        </button>
      </div>
    </div>

    <div class="buscador-fecha">
      <label for="buscadorFecha">Buscar por fecha:</label>
      <input type="date" id="buscadorFecha" />
      <label for="filtroEstado" style="margin-left: 1rem;">Filtrar por estado:</label>
      <select id="filtroEstado" style="padding: 4px; border-radius: 4px; border: 1px solid #ccc;">
        <option value="">Todos los estados</option>
        <option value="Pendiente">Pendiente</option>
        <option value="En Progreso">En Progreso</option>
        <option value="Completado">Completado</option>
      </select>
    </div>

    <!-- Vista de tarjetas -->
    <div class="grid-ordenes" id="contenedor-ordenes">
      <!-- Aquí se insertarán dinámicamente las tarjetas de órdenes -->
    </div>
    
    <!-- Vista de tabla (inicialmente oculta) -->
    <div class="table-container" id="tabla-ordenes" style="display: none; margin-top: 1.5rem; overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <thead>
          <tr style="background-color: #f8f9fa;">
            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">ID</th>
            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Cliente</th>
            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Servicio</th>
            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Fecha</th>
            <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Estado</th>
            <th style="padding: 12px 16px; text-align: right; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Acciones</th>
          </tr>
        </thead>
        <tbody id="tabla-ordenes-body">
          <!-- Las filas se insertarán dinámicamente con JavaScript -->
        </tbody>
      </table>
    </div>

    <!-- Vista de tabla estilo Admin -->
    <div class="admin-table-container" id="admin-tabla-ordenes-container" style="display: none; margin-top: 1.5rem; overflow-x: auto;">
      <table class="tabla-admin-ordenes" id="admin-orders-table" style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <thead>
          <tr style="background-color: #f0f2f5;">
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">ID Orden</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Cliente</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Fecha Compra</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Total Pagado</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Tipo Servicio</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Fecha Servicio</th>
            <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Estado</th>
            <th style="padding: 12px 15px; text-align: center; font-weight: 600; color: #333; border-bottom: 1px solid #e0e0e0;">Acciones</th>
          </tr>
        </thead>
        <tbody id="admin-tabla-ordenes-body">
          <!-- Las filas se insertarán aquí por JavaScript -->
        </tbody>
      </table>
    </div>
    <!-- Fin Vista de tabla estilo Admin -->
  </main>

  <!-- Modal para Editar Orden -->
  <div id="modalEditarOrden" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span class="modal-close-btn" onclick="cerrarModalEditar()">&times;</span>
      <h2>Editar Orden</h2>
      <form id="formEditarOrden" onsubmit="event.preventDefault(); guardarCambiosOrden();">
        <input type="hidden" id="editOrdenId" name="id">
        
        <div class="form-group">
          <label for="editOrdenDisplayId">ID Orden:</label>
          <input type="text" id="editOrdenDisplayId" name="displayId" readonly class="form-control-readonly">
        </div>
  
        <div class="form-group">
          <label for="editNombreCliente">Nombre:</label>
          <input type="text" id="editNombreCliente" name="nombre" required class="form-control">
        </div>
  
        <div class="form-group">
          <label for="editApellidoCliente">Apellido:</label>
          <input type="text" id="editApellidoCliente" name="apellido" class="form-control">
        </div>
  
        <div class="form-group">
          <label for="editCorreoCliente">Correo Electrónico:</label>
          <input type="email" id="editCorreoCliente" name="correo" class="form-control">
        </div>
  
        <div class="form-group">
          <label for="editTelefonoCliente">Teléfono:</label>
          <input type="tel" id="editTelefonoCliente" name="telefono" class="form-control">
        </div>
  
        <div class="form-group">
          <label for="editEstadoOrden">Estado de la Orden:</label>
          <select id="editEstadoOrden" name="estado" class="form-control">
            <option value="Pendiente">Pendiente</option>
            <option value="En Progreso">En Progreso</option>
            <option value="Completado">Completado</option>
            <option value="Cancelado">Cancelado</option>
          </select>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="cerrarModalEditar()">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>


  <footer class="footer">
    <div class="footer-container">
      <div class="footer-brand">
        <img src="../assets/img/kreative_white_logo.png" alt="Logo" class="footer-logo">
      </div>
      <div class="footer-section">
        <h3>Navegación</h3>
        <ul>
          <li><a href="../index.html#perfiles">Nuestro equipo</a></li>
          <li><a href="../index.html#pro">Proyectos</a></li>
          <li><a href="../index.html#contacto">Contáctanos</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Contacto</h3>
        <ul class="contact-info">
          <li class="contacto-nombre">Mauro Rojas</li>
          <li class="contacto-encargado">Director general de alphadocere</li>
          <li>
            <i class="far fa-envelope"></i>
            <a href="#">kreativegen10@gmail.com</a>
          </li>
          <li>
            <i class="fab fa-whatsapp"></i>
            <a href="https://wa.me/945429495" target="_blank">+56 945429495</a>
          </li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Síguenos</h3>
        <ul class="social-links">
          <li>
            <a href="https://www.youtube.com/@alphadocereapoyosocioemoci4979" target="_blank" class="social-link youtube">
              <i class="fab fa-youtube"></i>
              <span>YouTube</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p class="copyright">
        Copyright 2024 Kreative v. gen 13 Inicial | Todos los derechos reservados por empresa Kreative
      </p>
    </div>
  </footer>

  <script src="../frontend/js/verifylogin.js"></script>
  <script src="../frontend/js/ordenes-servicios.js"></script>
  <script src="../frontend/js/logout.js"></script>
  <script src="../frontend/js/timeout.js"></script>
  <script src="../frontend/js/hamburger-menu.js"></script>
</body>
</html>
